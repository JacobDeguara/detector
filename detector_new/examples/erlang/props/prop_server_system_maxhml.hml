with
  server_system:loop(_)
check
  [{_ <- _, server_system:loop(_)}]
  max X.(
    [{_ ? {_, {rec, _}}}]
      (
        [{_:_ ! {ok, msg}}]X
        and
        [{_:_ ! {ok, special}}]
          (
            [{_:_ ! {ok, alloc}}]ff
            or
            [{_:_ ! {ok, closing}}]ff
          )
      )
  ).